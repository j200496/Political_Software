<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-5 col-11 col-md-8">
      <h1
        class="text-success mt-4 mb-4 fw-bold"
        style="font-family: Georgia, 'Times New Roman', Times, serif"
      >
        Panel administrador
      </h1>
    </div>
  </div>
  <div class="row justify-content-start">
    <div class="col-lg-10">
      <h5 class="fst-italic">Bienvenido: compa√±ero(a) {{ usuario }}</h5>
    </div>
  </div>
  <div class="row justify-content-end">
    <div class="col-lg-4 col-12">
      <div class="shadow-lg">
        <div
          style="background-color: rgb(6, 165, 72)"
          class="text-white rounded-3"
        >
          <h5 style="padding: 8%">
            <i class="bi bi-people-fill fs-3"></i> Total inscritos:
            {{ TotalMiembro }}
          </h5>
        </div>
      </div>
    </div>
  </div>
  <div class="row justify-content-center">
    <div class="col-lg-4 col-11 col-md-6">
      <h3 class="text-success mt-4 mb-4 fst-italic">
        Lista de todos los miembros
      </h3>
    </div>
  </div>
  <div class="row justify-content-start mb-2">
    <div class="col-lg-6 col-md-6 mt-4">
      <input
        [(ngModel)]="pleople"
        (input)="FindName()"
        class="form form-control"
        type="text"
        placeholder="Buscar por nombre"
      />
    </div>
    <div class="col-lg-6 col-12 col-md-6 ps-3">
      <label for="bprov">Buscar por territorios</label>
      <ng-select
        id="bprov"
        class="form form-control"
        [items]="provincias"
        bindLabel="nombre"
        bindValue="nombre"
        placeholder=""
        [(ngModel)]="buscarprov"
        (change)="FindTerritory()"
        [searchable]="true"
        clearAllText="Clear"
      >
      </ng-select>
    </div>
  </div>
  <div class="row justify-content-center">
    <div class="col-lg-12 col-12">
      <div
        class="table-responsive border"
        style="max-height: 750px; overflow-y: auto"
      >
        <table id="TablaPersonas" class="table table-hover mt-4">
          <thead class="">
            <tr class="">
              <th>Nombre</th>
              <th>Telefono</th>
              <th>Direccion</th>
              <th>Colegio electoral</th>
              <th>Territorio</th>
              <th>Usuario</th>
              <th class="no-export" style="padding-left: 5%">Acciones</th>
            </tr>
          </thead>
          <tbody>
            @for(p of FindPeople; track p.idPersona){
            <tr>
              <td>{{ p.nombre | titlecase }}</td>
              <td>{{ p.telefono }}</td>
              <td>{{ p.direccion }}</td>
              <td>{{ p.cedula | titlecase }}</td>
              <td>{{ p.provincia | titlecase }}</td>
              <td>{{ p.usuario | titlecase }}</td>
              <td class="d-flex gap-2 no-export">
                <button
                  class="btn btn-success"
                  routerLink="/layout/update/{{ p.idPersona }}"
                >
                  Editar
                </button>
                <button class="btn btn-danger" (click)="borrar(p.idPersona)">
                  Borrar
                </button>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>
      <div class="row justify-content-center">
        <div class="col-lg-6 col-10">
          <button
            class="btn btn-success mt-3 mb-5 w-100"
            (click)="ExportToExcel()"
          >
            <i class="bi bi-file-earmark-arrow-down-fill"></i> Descargar a excel
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="row justify-content-start"></div>
  <hr />
  <div class="row justify-content-center">
    <div class="col-lg-5 col-12 col-md-8">
      <h4 class="text-success">Total de miembros por territorios</h4>
    </div>
  </div>
  <div class="row justify-content-center">
    <div class="col-lg-4" *ngFor="let m of totalmiembros">
      <div class="shadow-lg" data-aos="flip-left">
        <div
          style="background-color: rgb(6, 165, 72)"
          class="text-white rounded-3" data-aos="flip-left"
        >
          <h5 style="padding: 8%">
            <i class="bi bi-geo-alt-fill"></i> {{ m.provincia }}:
            {{ m.cantidad }}
          </h5>
        </div>
      </div>
    </div>
  </div>
  <hr />
  <div class="row justify-content-center">
    <div class="col-lg-3 col-6 col-md-3">
      <h2 class="text-success">Metas <i class="bi bi-star"></i><i class="bi bi-star-half"></i>
      <i class="bi bi-star-fill"></i></h2>
    </div>
  </div>
  <div class="row justify-content-center">
    <div class="col-lg-12 col-12 mb-2" *ngFor="let m of totalmiembros">
      <p class="fw-bold">{{ m.provincia }}</p>
      <p>Meta: {{ m.meta }} miembros</p>
      <div
        class="progress" 
        role="progressbar"
        aria-label="Example 20px high"
        [attr.aria-valuenow]="m.cantidad"
        [attr.aria-valuemin]="0"
        [attr.aria-valuemax]="m.meta"
        style="height: 40px;" data-aos="fade-right"
      >   
        <div
          class="progress-bar" style="background-color: rgb(84, 206, 84);"
          [style.width.%]="(m.cantidad / m.meta) * 100"
        >
          @if(m.cantidad == m.meta){
          <span class="text-white">Meta lograda!</span>
          }@else{
          <span>{{ m.cantidad }}/{{ m.meta }}</span>
          }
        </div>
      </div>
    </div>
  </div>
  <div class="row justify-content-center"data-aos="fade-down">
    <div class="col-lg-8 mt-2">
      <app-charts></app-charts>
    </div>
  </div>
</div>
<section class="">
  <app-footer></app-footer>
</section>
